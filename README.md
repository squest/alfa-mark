# Alfa-benchmark

Benchmarking several clojure libraries for web development and their combinations  
- Servers : http-kit, jetty9, undertow (through immutant2)  
- Templating : selmer, hiccup, enlive, laser  
- Database : couchdb (clutch), couchbase (couchbase-clj), mysql (korma), redis (carmine)  

Couchdb isn't included in some of the test since it's very slow for this kind of benchmark, it's better suited to other things.

## The challenges

First challenge: Render a page with a size-50 loop content grabbed from db (1 query per request) serving 100 requests each time.  

Preliminary results  

The numbers at the end indicates the number of total characters generated by the template  

"Elapsed time: 149.569728 msecs"
:httpkit :selmer couchbase 126100  
"Elapsed time: 1817.772256 msecs"
:httpkit :selmer couchdb 126100  
"Elapsed time: 89.195498 msecs"
:httpkit :selmer mysql 135400  
"Elapsed time: 288.660692 msecs"
:httpkit :selmer redis 126100  
"Elapsed time: 119.518024 msecs"
:httpkit :hiccup couchbase 91200  
"Elapsed time: 1967.130052 msecs"
:httpkit :hiccup couchdb 91200  
"Elapsed time: 80.220526 msecs"
:httpkit :hiccup mysql 97900  
"Elapsed time: 293.966166 msecs"
:httpkit :hiccup redis 91200  
"Elapsed time: 296.06159 msecs"
:httpkit :enlive couchbase 138400  
"Elapsed time: 3128.43194 msecs"
:httpkit :enlive couchdb 138400  
"Elapsed time: 218.170152 msecs"
:httpkit :enlive mysql 149100  
"Elapsed time: 619.490326 msecs"
:httpkit :enlive redis 138400  
"Elapsed time: 239.274888 msecs"
:httpkit :laser couchbase 137700  
"Elapsed time: 2112.795676 msecs"
:httpkit :laser couchdb 137700  
"Elapsed time: 146.91433 msecs"
:httpkit :laser mysql 148400  
"Elapsed time: 484.67185 msecs"
:httpkit :laser redis 137700  
"Elapsed time: 189.127964 msecs"
:undertow :selmer couchbase 126100  
"Elapsed time: 4650.368506 msecs"
:undertow :selmer couchdb 126100  
"Elapsed time: 178.477136 msecs"
:undertow :selmer mysql 135400  
"Elapsed time: 599.650986 msecs"
:undertow :selmer redis 126100  
"Elapsed time: 147.848556 msecs"
:undertow :hiccup couchbase 91200  
"Elapsed time: 2248.149858 msecs"
:undertow :hiccup couchdb 91200  
"Elapsed time: 83.282512 msecs"
:undertow :hiccup mysql 97900  
"Elapsed time: 416.97739 msecs"
:undertow :hiccup redis 91200  
"Elapsed time: 347.89228 msecs"
:undertow :enlive couchbase 138400  
"Elapsed time: 3225.862584 msecs"
:undertow :enlive couchdb 138400  
"Elapsed time: 158.3948 msecs"
:undertow :enlive mysql 149100  
"Elapsed time: 695.036388 msecs"
:undertow :enlive redis 138400  
"Elapsed time: 266.711352 msecs"
:undertow :laser couchbase 137700  
"Elapsed time: 2598.4977 msecs"
:undertow :laser couchdb 137700  
"Elapsed time: 182.999752 msecs"
:undertow :laser mysql 148400  
"Elapsed time: 737.76328 msecs"
:undertow :laser redis 137700  
"Elapsed time: 181.926964 msecs"
:jetty9 :selmer couchbase 126100  
"Elapsed time: 2737.420264 msecs"
:jetty9 :selmer couchdb 126100  
"Elapsed time: 138.015848 msecs"
:jetty9 :selmer mysql 135400  
"Elapsed time: 377.656962 msecs"
:jetty9 :selmer redis 126100  
"Elapsed time: 109.285634 msecs"
:jetty9 :hiccup couchbase 91200  
"Elapsed time: 1858.005702 msecs"
:jetty9 :hiccup couchdb 91200  
"Elapsed time: 128.101054 msecs"
:jetty9 :hiccup mysql 97900  
"Elapsed time: 366.72783 msecs"
:jetty9 :hiccup redis 91200  
"Elapsed time: 253.239568 msecs"
:jetty9 :enlive couchbase 138400  
"Elapsed time: 3505.402812 msecs"
:jetty9 :enlive couchdb 138400  
"Elapsed time: 188.45915 msecs"
:jetty9 :enlive mysql 149100  
"Elapsed time: 424.946328 msecs"
:jetty9 :enlive redis 138400  
"Elapsed time: 270.877602 msecs"
:jetty9 :laser couchbase 137700  
"Elapsed time: 1957.728714 msecs"
:jetty9 :laser couchdb 137700  
"Elapsed time: 171.97705 msecs"
:jetty9 :laser mysql 148400  
"Elapsed time: 362.047906 msecs"
:jetty9 :laser redis 137700  
  
Round 2 : 300 times rendering a page with 20 queries each http-request.  
  
Preliminary result   

"Elapsed time: 604.919688 msecs"
:jetty9 :selmer couchbase 378300  
"Elapsed time: 3885.75229 msecs"
:jetty9 :selmer mysql 378300  
"Elapsed time: 923.853082 msecs"
:jetty9 :selmer redis 378300  
"Elapsed time: 473.007546 msecs"
:jetty9 :hiccup couchbase 273600  
"Elapsed time: 4158.362238 msecs"
:jetty9 :hiccup mysql 273600  
"Elapsed time: 769.688038 msecs"
:jetty9 :hiccup redis 273600  
"Elapsed time: 1021.005418 msecs"
:jetty9 :enlive couchbase 328800  
"Elapsed time: 7747.257286 msecs"
:jetty9 :enlive mysql 328800  
"Elapsed time: 1628.95876 msecs"
:jetty9 :enlive redis 328800  
"Elapsed time: 714.613206 msecs"
:jetty9 :laser couchbase 413100  
"Elapsed time: 4296.988022 msecs"
:jetty9 :laser mysql 413100  
"Elapsed time: 1159.235924 msecs"
:jetty9 :laser redis 413100  

"Elapsed time: 453.98066 msecs"
:http-kit :selmer couchbase 378300  
"Elapsed time: 2392.419206 msecs"
:http-kit :selmer mysql 378300  
"Elapsed time: 763.88123 msecs"
:http-kit :selmer redis 378300  
"Elapsed time: 394.239746 msecs"
:http-kit :hiccup couchbase 273600  
"Elapsed time: 2596.736218 msecs"
:http-kit :hiccup mysql 273600  
"Elapsed time: 618.408036 msecs"
:http-kit :hiccup redis 273600  
"Elapsed time: 835.038888 msecs"
:http-kit :enlive couchbase 328800  
"Elapsed time: 5452.861826 msecs"
:http-kit :enlive mysql 328800  
"Elapsed time: 1506.332592 msecs"
:http-kit :enlive redis 328800  
"Elapsed time: 642.54605 msecs"
:http-kit :laser couchbase 413100  
"Elapsed time: 2744.846044 msecs"
:http-kit :laser mysql 413100  
"Elapsed time: 1004.650072 msecs"
:http-kit :laser redis 413100    
  
"Elapsed time: 339.553257 msecs"
:undertow :selmer couchbase 378300  
"Elapsed time: 3744.896082 msecs"
:undertow :selmer mysql 378300  
"Elapsed time: 696.91626 msecs"
:undertow :selmer redis 378300  
"Elapsed time: 478.389282 msecs"
:undertow :hiccup couchbase 273600  
"Elapsed time: 4308.705594 msecs"
:undertow :hiccup mysql 273600  
"Elapsed time: 696.853006 msecs"
:undertow :hiccup redis 273600  
"Elapsed time: 792.049436 msecs"
:undertow :enlive couchbase 328800  
"Elapsed time: 7501.820148 msecs"
:undertow :enlive mysql 328800  
"Elapsed time: 1615.149756 msecs"
:undertow :enlive redis 328800  
"Elapsed time: 613.540148 msecs"
:undertow :laser couchbase 413100  
"Elapsed time: 3825.39754 msecs"
:undertow :laser mysql 413100  
"Elapsed time: 925.44777 msecs"
:undertow :laser redis 413100   

Round 3 : Serving 1000 http-requests each rendering a page containing data that needs 30 queries each.  

(["1681ms" :http-kit :selmer "couchbase"]  
 ["1828ms" :http-kit :hiccup "couchbase"]  
 ["1851ms" :undertow :hiccup "couchbase"]  
 ["2005ms" :jetty9 :selmer "couchbase"]  
 ["2195ms" :undertow :selmer "couchbase"]  
 ["2631ms" :undertow :laser "couchbase"]  
 ["2760ms" :http-kit :laser "couchbase"]  
 ["3273ms" :http-kit :selmer "redis"]  
 ["3374ms" :jetty9 :hiccup "couchbase"]  
 ["3381ms" :jetty9 :laser "couchbase"]  
 ["3542ms" :undertow :selmer "redis"]  
 ["3682ms" :http-kit :hiccup "redis"]  
 ["3933ms" :undertow :hiccup "redis"]  
 ["4252ms" :jetty9 :selmer "redis"]  
 ["4688ms" :http-kit :laser "redis"]  
 ["4885ms" :jetty9 :enlive "redis"]  
 ["5050ms" :http-kit :enlive "couchbase"]  
 ["5193ms" :undertow :laser "redis"]  
 ["6995ms" :jetty9 :enlive "couchbase"]  
 ["8213ms" :undertow :enlive "couchbase"]  
 ["9908ms" :http-kit :enlive "redis"]  
 ["13904ms" :undertow :enlive "redis"]  
 ["13942ms" :http-kit :hiccup "mysql"]  
 ["14982ms" :http-kit :selmer "mysql"]  
 ["18919ms" :http-kit :laser "mysql"]  
 ["20029ms" :undertow :selmer "mysql"]  
 ["20677ms" :jetty9 :hiccup "mysql"]  
 ["20781ms" :jetty9 :selmer "mysql"]  
 ["21235ms" :jetty9 :laser "mysql"]  
 ["21669ms" :undertow :laser "mysql"]  
 ["23599ms" :undertow :hiccup "mysql"]  
 ["31733ms" :jetty9 :hiccup "redis"]  
 ["31825ms" :http-kit :enlive "mysql"]  
 ["32020ms" :jetty9 :laser "redis"]  
 ["42575ms" :undertow :enlive "mysql"]  
 ["44124ms" :jetty9 :enlive "mysql"])  
  
## License

Copyright Â© 2014 PT Zenius Education
